#!/bin/bash

####################################################
#           PLEASE DO NOT EDIT THIS FILE           #
#       IF YOU DON'T KNOW WHAT YOU ARE DOING       #
####################################################

. configuration

clear
echo -e "\033[34;1m"
echo "  @@  @@   @@@@  @@   @@  @@@@   @@@@   @@@@ "
echo " @@@@@@@@ @@@@@@ @@@  @@ @@  @@ @@  @@ @@    "
echo " @@ @@ @@ @@  @@ @@@@ @@ @@     @@  @@ @@@@@ "
echo " @@ @@ @@ @@@@@@ @@ @@@@ @@@@@@ @@  @@     @@"
echo " @@ @@ @@ @@  @@ @@  @@@ @@  @@ @@  @@ @@  @@"
echo " @@ @@ @@ @@  @@ @@   @@  @@@@   @@@@   @@@@ "
echo " --------------------------------------------"
echo "                 Downloader                  "
echo " --------------------------------------------"
echo -e "\033[0m"

#              CLEANUP MANGOS SOURCES              #
####################################################

if [ -e $SOURCES ]
then
  echo " "
  echo " "
  echo "Cleaning MaNGOS Source Modifications..."
  cd $SOURCES
  git reset --hard
fi

if [ ${DOPAUSE} = 1 ] 
then
  pause
fi

#          DOWNLOAD AND/OR UPDATE MANGOS           #
####################################################

if [ ! -e $SOURCES ]
then
  echo " "
  echo " "
  echo "Downloading MaNGOS Sources..."
  git clone $GITURL $SOURCES
fi

echo " "
echo " "
echo "Updating MaNGOS Sources..."
cd $SOURCES
git pull

REVTXT=$(grep 'define REVISION_NR' $SOURCES/src/shared/revision_nr.h)
REVNUM=${REVTXT:22:4}
echo "At revision $REVNUM."

if [ ${DOPAUSE} = 1 ] 
then
  pause
fi

echo " "
echo " "